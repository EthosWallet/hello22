# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 3

# CRITICAL INDICATORS IN LOCKFILE:

# 1. Packages without source = resolved from crates.io (DANGER!)
[[package]]
name = "company-keys"
version = "0.1.0"
# NO SOURCE FIELD = came from crates.io instead of internal path!
# This should have: source = "path+file://..."
dependencies = [
    "serde",
    "rand",
]

[[package]]
name = "key-derivation"  
version = "1.0.0"
# Missing source field - resolved from crates.io!
# High risk of typosquatting attack
dependencies = [
    "sha2",
    "pbkdf2",
]

[[package]]
name = "session-tokens"
version = "0.2.0"
# Another internal package name that resolved from crates.io
# instead of internal source - CRITICAL vulnerability!

[[package]]
name = "crypto-config"
version = "0.1.0"
# Configuration package from public registry instead of internal
dependencies = [
    "toml",
    "serde",
]

# 2. Version mismatches - requested vs resolved
[[package]]
name = "random-generator" 
version = "2.3.1"  # Wildcard "*" resolved to latest public version
# Could be malicious if attacker published higher version
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a1b2c3d4e5f6..."

[[package]]
name = "secure-random"
version = "0.9.5"  # ">=0.1" constraint allowed potentially malicious newer version
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f9e8a7b2..."

# 3. Git dependencies resolved to different commits than expected
[[package]]
name = "company-pki"
version = "0.2.0"
source = "git+https://github.com/company/pki.git#a1b2c3d4"  # Could be manipulated commit
dependencies = [
    "x509-parser",
    "der",
]

[[package]]
name = "cert-validator"
version = "0.3.1"
source = "git+https://github.com/internal/cert-validator.git?branch=main#e5f6a7b8"
# Branch reference can change, not pinned to specific commit

# 4. Legitimate internal packages (should have path sources)
[[package]]
name = "crypto-utils"
version = "0.1.2"
source = "path+file:///workspace/libs/crypto-utils"  # CORRECT - path source
dependencies = [
    "aes",
    "sha2",
]

[[package]]
name = "session-crypto"
version = "0.1.2"  
source = "path+file:///workspace/services/auth-service/crypto-service"  # CORRECT
dependencies = [
    "company-keys",  # PROBLEM: This resolved to crates.io version!
    "key-derivation",
    "session-tokens",
    "crypto-config",
    "crypto-utils",
]

# 5. Patched/replaced packages showing overrides
[[package]]
name = "ring"
version = "0.16.20"
source = "path+file:///workspace/vendor/ring-custom"  # Patched version
# Original would be: source = "registry+https://github.com/rust-lang/crates.io-index"

[[package]]
name = "rand"
version = "0.8.5"
source = "path+file:///workspace/libs/custom-rand"  # Replaced via [replace]
# This replacement could introduce vulnerabilities

# 6. Development and build dependencies with issues
[[package]]
name = "test-vectors"
version = "0.1.0"
# Missing source = from crates.io instead of internal test data
dependencies = [
    "hex",
    "serde_json",
]

[[package]]
name = "key-codegen"
version = "0.1.0" 
# Build dependency from crates.io - could inject malicious build code!
dependencies = [
    "proc-macro2",
    "quote",
    "syn",
]

# 7. Target-specific dependencies with confusion
[[package]]
name = "aes-ni"
version = "0.1.0"
# Hardware crypto from public registry - could be malicious implementation

[[package]]
name = "intel-crypto"
version = "0.2.0"
# Vendor-specific crypto from unknown source

# 8. Optional dependencies that weren't expected to resolve
[[package]]
name = "encryption-hardware"
version = "0.3.0"
# Optional feature enabled, resolved from crates.io instead of internal
dependencies = [
    "libc",
    "nix",
]

[[package]]
name = "hsm-interface" 
version = "1.0.0"
# Hardware Security Module interface from public registry - HIGH RISK!

# 9. Transitive dependencies that could be confused
[[package]]  
name = "utils"
version = "1.2.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
# Generic "utils" crate from public registry, likely not what was intended

[[package]]
name = "config"
version = "0.13.3" 
source = "registry+https://github.com/rust-lang/crates.io-index"
# "config" crate from public registry instead of internal config

# 10. Legitimate external dependencies (for comparison)
[[package]]
name = "serde"
version = "1.0.193"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "3cd8c33fbf28657a3dd1b2...")

[[package]]
name = "tokio"
version = "1.35.1"
source = "registry+https://github.com/rust-lang/crates.io-index" 
checksum = "c89b4efa943be685f629b149f53829423f8f5531ea21249408e8e2f8671ec104"

# Checksum validation would catch some attacks but not all
# Missing checksums indicate potential issues
